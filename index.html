<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>happy birthday Fiona üíó</title>
  <style>
    :root{
      --bg1:#fff1f6;
      --bg2:#ffe6ef;
      --card:#ffffffcc;
      --border:#ffc8da;
      --text:#5a2a3a;
      --muted:#7c4a5a;
      --shadow: 0 18px 40px rgba(90,42,58,.12);
      --shadow2: 0 10px 24px rgba(90,42,58,.10);
      --accent:#ff76a8;
      --accent2:#ff9cc2;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100svh;
      font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1200px 800px at 20% 10%, #ffffff 0%, transparent 45%),
        radial-gradient(1200px 800px at 80% 30%, #ffffff 0%, transparent 45%),
        linear-gradient(160deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }

    /* Floating click emojis */
    .pop{
      position:fixed;
      left:0; top:0;
      transform:translate(-50%,-50%);
      pointer-events:none;
      font-size:28px;
      animation: floatUp 1.1s ease-out forwards;
      filter: drop-shadow(0 8px 14px rgba(255,118,168,.35));
      user-select:none;
      will-change: transform, opacity;
    }
    .glow-heart{
      text-shadow:
        0 0 10px rgba(255,118,168,.85),
        0 0 18px rgba(255,118,168,.65),
        0 0 28px rgba(255,118,168,.45);
    }
    @keyframes floatUp{
      0%{ opacity:0; transform:translate(-50%,-50%) scale(.9); }
      10%{ opacity:1; }
      100%{ opacity:0; transform:translate(-50%,-120px) scale(1.25); }
    }

    /* Layout */
    .wrap{
      max-width:980px;
      margin:0 auto;
      padding:24px 16px 60px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 14px;
      border:1px solid var(--border);
      border-radius:18px;
      background:var(--card);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(10px);
      position:sticky;
      top:10px;
      z-index:10;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 0;
    }
    .brand .logo{
      width:40px;height:40px;
      border-radius:14px;
      display:grid;place-items:center;
      background: linear-gradient(140deg, #fff, #ffe0ee);
      border:1px solid var(--border);
      box-shadow: 0 8px 18px rgba(255,118,168,.18);
      flex:0 0 auto;
    }
    .brand h1{
      font-size:16px;
      margin:0;
      line-height:1.1;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .brand p{
      margin:0;
      font-size:12px;
      color:var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .userchip{
      display:flex;
      align-items:center;
      gap:10px;
      flex:0 0 auto;
    }
    .chip{
      padding:8px 12px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#fff;
      font-size:13px;
      color:var(--muted);
      box-shadow: 0 10px 18px rgba(90,42,58,.08);
    }
    .btn{
      appearance:none;
      border:1px solid var(--border);
      background: linear-gradient(180deg, #fff, #ffe7f0);
      color:var(--text);
      padding:9px 12px;
      border-radius:999px;
      cursor:pointer;
      box-shadow: 0 10px 18px rgba(90,42,58,.08);
      transition: transform .08s ease, box-shadow .2s ease;
      font-weight:700;
      font-size:13px;
    }
    .btn:active{ transform: translateY(1px); box-shadow: 0 6px 14px rgba(90,42,58,.10); }

    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
      margin-top:16px;
    }
    @media (max-width: 860px){
      .grid{ grid-template-columns:1fr; }
    }

    .card{
      border:1px solid var(--border);
      border-radius:22px;
      background:var(--card);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    .card .inner{ padding:18px; }

    .hero{
      display:flex;
      gap:16px;
      align-items:stretch;
    }
    @media (max-width: 540px){
      .hero{ flex-direction:column; }
    }

    .photoSlot, .gifSlot{
      border-radius:18px;
      border:1px dashed #ff9fc4;
      background:
        radial-gradient(800px 300px at 10% 10%, #ffffff 0%, transparent 55%),
        linear-gradient(160deg, #fff, #ffe7f0);
      min-height:220px;
      flex:1 1 auto;
      position:relative;
      display:grid;
      place-items:center;
      text-align:center;
      padding:14px;
      overflow:hidden;
    }
    .slotTitle{
      font-weight:900;
      letter-spacing:.2px;
      margin:0 0 6px;
    }
    .slotHint{
      margin:0;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }
    .slotBadge{
      position:absolute;
      top:12px; left:12px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      background:#ffffffd9;
      font-size:12px;
      color:var(--muted);
      box-shadow: 0 10px 16px rgba(90,42,58,.08);
    }

    /* nav tiles */
    .tiles{
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
    }
    .tile{
      cursor:pointer;
      border-radius:18px;
      border:1px solid var(--border);
      background: linear-gradient(180deg, #fff, #ffe7f0);
      padding:14px;
      box-shadow: var(--shadow2);
      transition: transform .12s ease, box-shadow .2s ease;
      position:relative;
      overflow:hidden;
    }
    .tile:hover{ transform: translateY(-2px); box-shadow: 0 14px 28px rgba(90,42,58,.12); }
    .tile .big{
      font-size:18px;
      font-weight:900;
      margin:0;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .tile .small{
      margin:6px 0 0;
      color:var(--muted);
      font-size:13px;
      line-height:1.35;
    }
    .sparkle{
      position:absolute;
      right:-12px; top:-12px;
      width:120px; height:120px;
      border-radius:50%;
      background: radial-gradient(circle at 30% 30%, rgba(255,118,168,.35), transparent 60%);
      filter: blur(0.2px);
      pointer-events:none;
    }

    /* Pages */
    .page{ display:none; }
    .page.active{ display:block; }

    /* Gate */
    .gate{
      min-height:100svh;
      display:grid;
      place-items:center;
      padding:24px 16px;
    }
    .gateCard{
      width:min(720px, 100%);
      border-radius:26px;
      border:1px solid var(--border);
      background: var(--card);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      padding:20px;
      overflow:hidden;
      position:relative;
    }
    .gateCard:before{
      content:"";
      position:absolute;
      inset:-2px;
      background: radial-gradient(circle at 20% 10%, rgba(255,118,168,.20), transparent 50%),
                  radial-gradient(circle at 80% 30%, rgba(255,156,194,.18), transparent 55%);
      pointer-events:none;
    }
    .gateInner{ position:relative; }
    .gateTitle{
      margin:0 0 6px;
      font-size:26px;
      letter-spacing:.2px;
    }
    .gateSub{
      margin:0 0 16px;
      color:var(--muted);
      line-height:1.5;
    }
    .inputRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    input[type="text"]{
      flex:1 1 240px;
      border:1px solid var(--border);
      border-radius:14px;
      padding:12px 12px;
      font-size:14px;
      outline:none;
      background:#fff;
      box-shadow: 0 10px 18px rgba(90,42,58,.06);
    }
    input[type="text"]:focus{
      border-color:#ff9cc2;
      box-shadow: 0 0 0 4px rgba(255,118,168,.14);
    }
    .enterBtn{
      padding:12px 14px;
      border-radius:14px;
      border:1px solid #ff9cc2;
      background: linear-gradient(180deg, #fff, #ffd9e8);
      cursor:pointer;
      font-weight:900;
      box-shadow: 0 14px 24px rgba(255,118,168,.18);
    }
    .enterBtn:active{ transform: translateY(1px); }

    /* Card page */
    .bigTitle{
      font-size:22px;
      margin:2px 0 8px;
      font-weight:1000;
      letter-spacing:.2px;
    }
    .para{
      margin:0 0 12px;
      color:var(--muted);
      line-height:1.55;
      font-size:14px;
    }
    .placeholderBox{
      border-radius:18px;
      border:1px dashed #ff9fc4;
      padding:14px;
      background: linear-gradient(180deg, #fff, #ffeef5);
    }

    /* Game */
    .gameWrap{
      display:grid;
      gap:12px;
    }
    canvas{
      width:100%;
      height:360px;
      border-radius:18px;
      border:1px solid var(--border);
      background: linear-gradient(180deg, #fff, #ffe8f1);
      box-shadow: var(--shadow2);
      display:block;
    }
    .gameBar{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      flex-wrap:wrap;
    }
    .kbd{
      padding:8px 10px;
      border:1px solid var(--border);
      border-radius:12px;
      background:#fff;
      color:var(--muted);
      font-size:12px;
      box-shadow: 0 10px 18px rgba(90,42,58,.06);
    }
    .miniBtn{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid #ff9cc2;
      background: linear-gradient(180deg, #fff, #ffd9e8);
      cursor:pointer;
      font-weight:900;
      box-shadow: 0 14px 22px rgba(255,118,168,.16);
    }

    /* Footer note */
    .note{
      margin-top:14px;
      color:var(--muted);
      font-size:12px;
      text-align:center;
    }

    /* Small cute divider */
    .divider{
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(255,118,168,.45), transparent);
      margin:14px 0;
    }

    /* Hide main app until entered */
    #app{ display:none; }
  </style>
</head>

<body>
  <!-- Name Gate -->
  <section id="gate" class="gate">
    <div class="gateCard">
      <div class="gateInner">
        <p style="margin:0 0 6px;color:var(--muted);font-weight:800;">üéÄüê∞üíó</p>
        <h2 class="gateTitle">hi fiona - lisa</h2>
        <p class="gateSub">you have to type your name.</p>

        <div class="inputRow">
          <input id="nameInput" type="text" maxlength="24" placeholder="Your name..." autocomplete="name" />
          <button id="enterBtn" class="enterBtn">Enter üíó</button>
        </div>

        <div class="divider"></div>
        <p class="para" style="margin:0;">
          click anywhere! i did something 
        </p>
      </div>
    </div>
  </section>

  <!-- Main App -->
  <div id="app" class="wrap">
    <header class="topbar">
      <div class="brand">
        <div class="logo">üíó</div>
        <div style="min-width:0">
          <h1 id="titleLine">fiona's 15th</h1>
          <p id="welcomeLine">i made you a static site do you like it? (it's pink too)</p>
        </div>
      </div>

      <div class="userchip">
        <span class="chip" id="nameChip">Guest</span>
        <button class="btn" id="changeNameBtn">Change name</button>
      </div>
    </header>

    <!-- HOME -->
    <section id="home" class="page active">
      <div class="grid">
        <div class="card">
          <div class="inner">
            <h3 class="bigTitle">Home üíó</h3>
            <p class="para">
              Happy birthday Fiona!! üéÄüê∞üíó
              <br/>try clicking anywhere on the screen, i did something. also you can click onto the top right corner
            </p>

            <div class="hero">
              <!-- Photo slot -->
              <div class="photoSlot">
                <span class="slotBadge">Photo slot</span>
                <div>
                  <h4 class="slotTitle">üì∏ Fiona photo goes here</h4>
                  <p class="slotHint">
                    Replace the placeholder in the code with your image file later.
                  </p>
                </div>
              </div>

              <!-- GIF slot -->
              <div class="gifSlot">
                <span class="slotBadge">GIF slot</span>
                <div>
                  <h4 class="slotTitle">‚ú® GIF goes here</h4>
                  <p class="slotHint">
                    Replace the placeholder in the code with your gif later.
                  </p>
                </div>
              </div>
            </div>

            <p class="note">
              Tip: when you upload Fiona‚Äôs photo + gif, you‚Äôll just swap in the file names in the JS section.
            </p>
          </div>
        </div>

        <div class="tiles">
          <div class="tile" data-nav="cardPage">
            <div class="sparkle"></div>
            <p class="big">üíå card</p>
            <p class="small">HI FIONA HAPPY HAPPY BIRTHDAY YAYAYA you are finally 15 omg youngest in the friendgroup im so envious. this means you have to wait a year longer to get your drivers license but you will stay YOUTHFUL I guess! But anyways I just want to say thank you so much for everything, last year was such a peak year and we had so much fun in social studies HAHA and like every class, you genuinely made core class 100x better and I dont think I would have survived that month in the bush without you or Bella. You are also sososos freaking pretty and smart and funny!!! Like hello you look like this c-drama idol which I dont know the name of because I haven‚Äôt watched the show but she is so pretty and very very pale and ËÇåËÇ§Èõ™ÁôΩ (my Chinese isnt good but you get the idea right) also your notes are so good and even though I stopped playing genshin, watching you play brings back nostalgic memories of us in year 8. you are also so insanely good at history like how come you can play genshin with kokomi and citlali and stuff but also answer ‚Äúwhich hone heke signed the atomic bombing in nagasaki‚Äù without even looking up like please tutor me! Anyways thinking back on Alex (both of them) always makes me laugh HJDKBJAKHAFRKHBFABEHKRHKB okay anyways it is actually so funny HJAFHLHLEHLAFERLHAFE‚ÄúDo we write about after or during the earthquake?‚Äù ‚ÄúDear diary, Its 3am right now, the floor is shaking, I can smell the earthquake.‚Äù How is it still hilarious after 3 years??? BUT I HOPE YOU HAVE THE BEST 15TH I LOVE YOU SO MUCH FIONA UR SO SWEET AND GORGEOUS! </p>
          </div>

          <div class="tile" data-nav="gamePage">
            <div class="sparkle"></div>
            <p class="big">üéÆ game i made for you </p>
            <p class="small">Emoji runner (like Chrome Dino) - jump the bows üéÄ and collect hearts üíó.</p>
          </div>
        </div>
      </div>
    </section>

    <!-- CARD PAGE -->
    <section id="cardPage" class="page">
      <div class="card">
        <div class="inner">
          <button class="btn" data-nav="home">‚Üê Back</button>
          <h3 class="bigTitle" style="margin-top:10px;">card üíå</h3>
          <p class="para">
           HI FIONA HAPPY HAPPY BIRTHDAY YAYAYA you are finally 15 omg youngest in the friendgroup im so envious. this means you have to wait a year longer to get your drivers license but you will stay YOUTHFUL I guess! But anyways I just want to say thank you so much for everything, last year was such a peak year and we had so much fun in social studies HAHA and like every class, you genuinely made core class 100x better and I dont think I would have survived that month in the bush without you or Bella. You are also sososos freaking pretty and smart and funny!!! Like hello you look like this c-drama idol which I dont know the name of because I haven‚Äôt watched the show but she is so pretty and very very pale and ËÇåËÇ§Èõ™ÁôΩ (my Chinese isnt good but you get the idea right) also your notes are so good and even though I stopped playing genshin, watching you play brings back nostalgic memories of us in year 8. you are also so insanely good at history like how come you can play genshin with kokomi and citlali and stuff but also answer ‚Äúwhich hone heke signed the atomic bombing in nagasaki‚Äù without even looking up like please tutor me! Anyways thinking back on Alex (both of them) always makes me laugh HJDKBJAKHAFRKHBFABEHKRHKB okay anyways it is actually so funny HJAFHLHLEHLAFERLHAFE‚ÄúDo we write about after or during the earthquake?‚Äù ‚ÄúDear diary, Its 3am right now, the floor is shaking, I can smell the earthquake.‚Äù How is it still hilarious after 3 years??? BUT I HOPE YOU HAVE THE BEST 15TH I LOVE YOU SO MUCH FIONA UR SO SWEET AND GORGEOUS! 
          </p>

          <div class="placeholderBox" id="cardText">
            <p class="para" style="margin:0;">
              (Card text placeholder)
              <br/><br/>
              Replace this text with your message for Fiona üíó
            </p>
          </div>

          <div class="divider"></div>

          <p class="para" style="margin-bottom:0;">
            don't mind the best score i did a test trial 
          </p>
        </div>
      </div>
    </section>

    <!-- GAME PAGE -->
    <section id="gamePage" class="page">
      <div class="card">
        <div class="inner gameWrap">
          <div class="gameBar">
            <button class="btn" data-nav="home">‚Üê Back</button>
            <div class="kbd">Jump: Space / Tap</div>
            <div class="kbd">Restart: R</div>
            <div class="kbd">Goal: Dodge üéÄ, collect üíó</div>
          </div>

          <canvas id="game" width="900" height="360"></canvas>

          <div class="gameBar">
            <button class="miniBtn" id="startBtn">Start / Restart üéÆ</button>
            <div class="chip">Score: <span id="score">0</span></div>
            <div class="chip">Best: <span id="best">0</span></div>
          </div>

          <p class="note">i tried coding this for you because you are always on your ipad haha</p>
        </div>
      </div>
    </section>
  </div>

  <script>
    /* =========================
       CONFIG: swap these later
       ========================= */
    // After you have files, put them in the same folder and change:
    // PHOTO_SRC = "fiona.jpg" or "fiona.png"
    // GIF_SRC   = "fiona.gif"
    const PHOTO_SRC = ""; // e.g. "fiona.jpg"
    const GIF_SRC   = ""; // e.g. "fiona.gif"

    /* =========================
       Name gate + navigation
       ========================= */
    const gate = document.getElementById("gate");
    const app = document.getElementById("app");
    const nameInput = document.getElementById("nameInput");
    const enterBtn = document.getElementById("enterBtn");
    const nameChip = document.getElementById("nameChip");
    const welcomeLine = document.getElementById("welcomeLine");
    const changeNameBtn = document.getElementById("changeNameBtn");

    function setName(name){
      const clean = (name || "").trim().slice(0,24);
      if(!clean) return false;
      localStorage.setItem("fionaVisitorName", clean);
      nameChip.textContent = clean;
      welcomeLine.textContent = `Welcome, ${clean}!`;
      return true;
    }

    function showApp(){
      gate.style.display = "none";
      app.style.display = "block";
      // Load placeholders if sources provided
      injectMediaSlots();
    }

    function showGate(){
      app.style.display = "none";
      gate.style.display = "grid";
      setTimeout(()=>nameInput.focus(), 50);
    }

    function enter(){
      if(setName(nameInput.value)){
        showApp();
      } else {
        nameInput.focus();
        nameInput.style.boxShadow = "0 0 0 4px rgba(255,118,168,.18)";
        setTimeout(()=> nameInput.style.boxShadow = "", 400);
      }
    }

    enterBtn.addEventListener("click", enter);
    nameInput.addEventListener("keydown", (e)=>{
      if(e.key === "Enter") enter();
    });

    changeNameBtn.addEventListener("click", ()=>{
      localStorage.removeItem("fionaVisitorName");
      nameInput.value = "";
      showGate();
    });

    // On load
    const saved = localStorage.getItem("fionaVisitorName");
    if(saved){
      setName(saved);
      showApp();
    } else {
      showGate();
    }

    // Navigation system
    const pages = ["home","cardPage","gamePage"].map(id => document.getElementById(id));
    function go(pageId){
      pages.forEach(p => p.classList.toggle("active", p.id === pageId));
      // If entering game page, resize canvas to CSS size and pause until start
      if(pageId === "gamePage") gameFitCanvas();
    }
    document.querySelectorAll("[data-nav]").forEach(el=>{
      el.addEventListener("click", ()=> go(el.getAttribute("data-nav")));
    });

    /* =========================
       Photo + GIF slots injection
       ========================= */
    function injectMediaSlots(){
      // Replace the inside of the slots with actual media if sources exist
      const photoSlot = document.querySelector(".photoSlot");
      const gifSlot = document.querySelector(".gifSlot");

      if(PHOTO_SRC){
        photoSlot.innerHTML = `
          <span class="slotBadge">Photo</span>
          <img src="${PHOTO_SRC}" alt="Fiona" style="
            width:100%; height:100%; object-fit:cover;
            border-radius:18px;
          ">
        `;
      }
      if(GIF_SRC){
        gifSlot.innerHTML = `
          <span class="slotBadge">GIF</span>
          <img src="${GIF_SRC}" alt="Fiona GIF" style="
            width:100%; height:100%; object-fit:cover;
            border-radius:18px;
          ">
        `;
      }
    }

    /* =========================
       Click-anywhere emoji pops
       ========================= */
    const POPS = ["üéÄ","üê∞","üíó"];
    function popAt(x,y){
      const el = document.createElement("div");
      const choice = POPS[Math.floor(Math.random()*POPS.length)];
      el.className = "pop" + (choice === "üíó" ? " glow-heart" : "");
      el.textContent = choice;
      el.style.left = x + "px";
      el.style.top = y + "px";
      el.style.fontSize = (24 + Math.random()*18) + "px";
      document.body.appendChild(el);
      setTimeout(()=> el.remove(), 1150);
    }
    window.addEventListener("pointerdown", (e)=>{
      // Avoid clicking buttons from making it feel messy? Still allow: it‚Äôs cute.
      popAt(e.clientX, e.clientY);
    });

    /* =========================
       Mini Game: Emoji Runner
       - player: üê∞
       - obstacles: üéÄ
       - collectibles: üíó
       ========================= */
    const canvas = document.getElementById("game");
    const ctx = canvas.getContext("2d");

    const scoreEl = document.getElementById("score");
    const bestEl = document.getElementById("best");
    const startBtn = document.getElementById("startBtn");

    let best = Number(localStorage.getItem("fionaBestScore") || 0);
    bestEl.textContent = best;

    // Game state
    let running = false;
    let gameOver = false;
    let score = 0;
    let tPrev = 0;

    const world = {
      g: 2600,               // gravity
      groundY: 300,          // baseline
      speed: 520,            // world speed
      speedUp: 0.018,        // speed increase per score unit
    };

    const player = {
      x: 120,
      y: world.groundY,
      vy: 0,
      r: 20,                 // collision radius
      jumpV: -980,
      emoji: "üê∞",
      alive: true,
    };

    let obstacles = [];
    let hearts = [];

    function resetGame(){
      running = false;
      gameOver = false;
      score = 0;
      tPrev = performance.now();
      player.y = world.groundY;
      player.vy = 0;
      obstacles = [];
      hearts = [];
      scoreEl.textContent = "0";
    }

    function startGame(){
      resetGame();
      running = true;
      requestAnimationFrame(loop);
    }

    startBtn.addEventListener("click", startGame);

    function jump(){
      if(!running){
        // allow tap to start when on game page
        if(document.getElementById("gamePage").classList.contains("active")) startGame();
        return;
      }
      if(gameOver) return;
      // Only jump if near ground
      if(Math.abs(player.y - world.groundY) < 2){
        player.vy = player.jumpV;
      }
    }

    window.addEventListener("keydown", (e)=>{
      if(e.code === "Space"){ e.preventDefault(); jump(); }
      if(e.key.toLowerCase() === "r" && document.getElementById("gamePage").classList.contains("active")){
        startGame();
      }
    });

    canvas.addEventListener("pointerdown", ()=> jump());

    function spawnObstacle(){
      // Bow on the ground
      const size = 26 + Math.random()*10;
      obstacles.push({
        x: canvas.width + 30,
        y: world.groundY,
        r: size*0.55,
        emoji: "üéÄ",
        size
      });
    }

    function spawnHeart(){
      const size = 24 + Math.random()*10;
      hearts.push({
        x: canvas.width + 30,
        y: world.groundY - (70 + Math.random()*90),
        r: size*0.5,
        emoji: "üíó",
        size
      });
    }

    let nextObs = 0;
    let nextHeart = 0;

    function scheduleSpawns(){
      const now = performance.now();
      if(now > nextObs){
        spawnObstacle();
        // spawn interval shrinks as score grows
        const base = 900 - Math.min(420, score*2.2);
        nextObs = now + base + Math.random()*320;
      }
      if(now > nextHeart){
        // less frequent
        if(Math.random() < 0.8) spawnHeart();
        nextHeart = now + 1400 + Math.random()*900;
      }
    }

    function dist(ax,ay,bx,by){
      const dx = ax-bx, dy = ay-by;
      return Math.hypot(dx,dy);
    }

    function drawEmoji(emoji, x, y, size, glow=false){
      ctx.save();
      ctx.font = `${size}px ui-rounded, system-ui, Apple Color Emoji, Segoe UI Emoji`;
      ctx.textAlign = "center";
      ctx.textBaseline = "alphabetic";
      if(glow){
        ctx.shadowColor = "rgba(255,118,168,.75)";
        ctx.shadowBlur = 18;
      } else {
        ctx.shadowColor = "transparent";
        ctx.shadowBlur = 0;
      }
      // y is baseline; tweak so it looks centered on collision circle
      ctx.fillText(emoji, x, y + size*0.35);
      ctx.restore();
    }

    function draw(){
      // Clear
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // soft ground
      ctx.save();
      ctx.strokeStyle = "rgba(255,118,168,.35)";
      ctx.lineWidth = 4;
      ctx.beginPath();
      ctx.moveTo(0, world.groundY + 24);
      ctx.lineTo(canvas.width, world.groundY + 24);
      ctx.stroke();
      ctx.restore();

      // hearts
      for(const h of hearts){
        drawEmoji(h.emoji, h.x, h.y, h.size, true);
      }

      // obstacles
      for(const o of obstacles){
        drawEmoji(o.emoji, o.x, o.y, o.size, false);
      }

      // player
      drawEmoji(player.emoji, player.x, player.y, 38, false);

      // score text
      ctx.save();
      ctx.fillStyle = "rgba(90,42,58,.85)";
      ctx.font = "18px ui-rounded, system-ui";
      ctx.fillText(`Score: ${Math.floor(score)}`, 16, 28);
      ctx.restore();

      if(!running){
        ctx.save();
        ctx.fillStyle = "rgba(90,42,58,.75)";
        ctx.font = "20px ui-rounded, system-ui";
        ctx.textAlign = "center";
        ctx.fillText("Tap / Space to start & jump", canvas.width/2, 160);
        ctx.font = "14px ui-rounded, system-ui";
        ctx.fillText("Dodge üéÄ and collect üíó", canvas.width/2, 190);
        ctx.restore();
      }

      if(gameOver){
        ctx.save();
        ctx.fillStyle = "rgba(90,42,58,.80)";
        ctx.font = "28px ui-rounded, system-ui";
        ctx.textAlign = "center";
        ctx.fillText("Game Over", canvas.width/2, 155);
        ctx.font = "16px ui-rounded, system-ui";
        ctx.fillText("Press R or click Start/Restart", canvas.width/2, 185);
        ctx.restore();
      }
    }

    function update(dt){
      // Increase speed as score increases
      const speed = world.speed * (1 + world.speedUp * (score/100));

      // player physics
      player.vy += world.g * dt;
      player.y += player.vy * dt;
      if(player.y > world.groundY){
        player.y = world.groundY;
        player.vy = 0;
      }

      // move obstacles / hearts
      obstacles.forEach(o => o.x -= speed * dt);
      hearts.forEach(h => h.x -= speed * dt);

      // clean old
      obstacles = obstacles.filter(o => o.x > -80);
      hearts = hearts.filter(h => h.x > -80);

      // collisions with obstacles
      for(const o of obstacles){
        const d = dist(player.x, player.y, o.x, o.y);
        if(d < player.r + o.r){
          gameOver = true;
          running = true; // keep drawing gameover screen
          // best score
          const finalScore = Math.floor(score);
          if(finalScore > best){
            best = finalScore;
            localStorage.setItem("fionaBestScore", String(best));
            bestEl.textContent = best;
          }
          return;
        }
      }

      // collect hearts
      for(let i = hearts.length - 1; i >= 0; i--){
        const h = hearts[i];
        const d = dist(player.x, player.y, h.x, h.y);
        if(d < player.r + h.r){
          hearts.splice(i,1);
          score += 25; // bonus
          // cute pop on collect
          popAt(
            canvas.getBoundingClientRect().left + (h.x / canvas.width) * canvas.getBoundingClientRect().width,
            canvas.getBoundingClientRect().top + (h.y / canvas.height) * canvas.getBoundingClientRect().height
          );
        }
      }

      // base scoring
      score += dt * 40;
      scoreEl.textContent = String(Math.floor(score));

      scheduleSpawns();
    }

    function loop(tNow){
      const dt = Math.min(0.035, (tNow - tPrev) / 1000);
      tPrev = tNow;

      if(running && !gameOver){
        update(dt);
      }
      draw();

      if(running){
        requestAnimationFrame(loop);
      }
    }

    // Fit canvas for crispness on different screens
    function gameFitCanvas(){
      const rect = canvas.getBoundingClientRect();
      const dpr = Math.max(1, window.devicePixelRatio || 1);
      canvas.width = Math.floor(rect.width * dpr);
      canvas.height = Math.floor(rect.height * dpr);
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0); // use CSS pixels for coordinates
      // Re-set world ground based on CSS pixels
      world.groundY = rect.height - 60;
      // Reset to avoid weirdness
      running = false;
      gameOver = false;
      score = 0;
      obstacles = [];
      hearts = [];
      nextObs = performance.now() + 500;
      nextHeart = performance.now() + 900;
      draw();
    }

    window.addEventListener("resize", ()=>{
      if(document.getElementById("gamePage").classList.contains("active")) gameFitCanvas();
    });

    // initial canvas fit
    setTimeout(gameFitCanvas, 80);
  </script>
</body>
</html>
